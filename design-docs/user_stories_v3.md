# ユーザーストーリー: 相次相続シミュレーター v3

## ユーザーストーリー (Gherkin形式)

### Epic 1: 基本情報入力

**Feature: 被相続人情報の入力**

- **Scenario 1: 第1次相続情報の入力**
  - GIVEN ユーザーがシミュレーターのページを開いている
  - WHEN 第1次相続の被相続人名と死亡日を入力する
  - THEN 入力内容が画面に反映される

- **Scenario 2: 第2次相続情報の入力**
  - GIVEN ユーザーがシミュレーターのページを開いている
  - WHEN 第2次相続の被相続人名と死亡日を入力する
  - THEN 入力内容が画面に反映される

- **Scenario 3: 相続期間の自動計算**
  - GIVEN 第1次相続と第2次相続の死亡日が入力されている
  - WHEN ページが更新される
  - THEN 2つの死亡日の間の期間（年数）が自動で計算され、"E"として表示される

- **Scenario 4: 期間が10年を超える場合の表示**
  - GIVEN 計算された期間 "E" が10年以上である
  - WHEN ページが更新される
  - THEN 相次相続控除の対象外である旨のメッセージが表示される

### Epic 2: 相続財産情報の入力

**Feature: 相次相続控除に関連する金額の入力**

- **Scenario 5: 前回の相続で取得した財産額の入力**
  - GIVEN ユーザーが財産情報セクションを見ている
  - WHEN 「前回の相続で取得した財産価額」(A) を入力する
  - THEN 入力した金額がフォーマットされて表示される

- **Scenario 6: 前回の相続で取得した負債額の入力**
  - GIVEN ユーザーが財産情報セクションを見ている
  - WHEN 「前回の相続で取得した負債価額」(B) を入力する
  - THEN 入力した金額がフォーマットされて表示される

- **Scenario 7: 今回の相続の総資産額の入力**
  - GIVEN ユーザーが財産情報セクションを見ている
  - WHEN 「今回の相続の純資産価額の合計」(C) を入力する
  - THEN 入力した金額がフォーマットされて表示される

### Epic 3: 相続人の管理

**Feature: 相続人情報の入力と管理**

- **Scenario 8: 初期相続人フォームの表示**
  - GIVEN ユーザーがページをロードする
  - WHEN 相続人セクションが表示される
  - THEN 少なくとも1つの相続人情報入力フォームが表示されている

- **Scenario 9: 新しい相続人の追加**
  - GIVEN ユーザーが相続人セクションを見ている
  - WHEN 「相続人を追加」ボタンをクリックする
  - THEN 新しい相続人情報入力フォームがリストの末尾に追加される

- **Scenario 10: 相続人の削除**
  - GIVEN 複数の相続人フォームが表示されている
  - WHEN 特定の相続人フォームの「削除」ボタンをクリックする
  - THEN そのフォームが削除され、相続人番号が更新される

- **Scenario 11: 相続人情報の入力**
  - GIVEN ユーザーが特定の相続人フォームを見ている
  - WHEN 相続人の名前、ステータス、「取得財産価額」(D) を入力する
  - THEN 入力内容がそのフォーム内に保持され、表示される

- **Scenario 12: 相続人ステータスの選択**
  - GIVEN ユーザーが相続人のステータス欄をクリックする
  - WHEN ドロップダウンリストから「法定相続人」「相続放棄」などを選択する
  - THEN 選択したステータスがフォームに反映される

### Epic 4: 計算と結果表示

**Feature: 相次相続控除額の自動計算と表示**

- **Scenario 13: 各相続人の控除額のリアルタイム計算**
  - GIVEN 必要なすべての値 (A, B, C, D, E) が入力されている
  - WHEN ユーザーが相続人の取得財産価額 (D) を変更する
  - THEN その相続人の相次相続控除額が即座に計算され、表示される

- **Scenario 14: いずれかの値が未入力の場合**
  - GIVEN 計算に必要な値のいずれかが欠けている
  - WHEN ユーザーがページを見る
  - THEN 控除額の計算結果エリアは「入力待ち」や「0」などを表示する

- **Scenario 15: 計算不能なケースの処理**
  - GIVEN `B - A` がゼロまたはマイナスになるなど、計算式が成立しない値が入力された
  - WHEN ページが更新される
  - THEN 控除額は0または計算不能である旨を示すメッセージを表示する

- **Scenario 16: 総控除額の表示**
  - GIVEN すべての相続人の控除額が計算されている
  - WHEN ページが更新される
  - THEN 全相続人の控除額の合計が、ページのサマリーエリアに表示される

### Epic 5: ユーザー体験 (UX)

**Feature: レスポンシブデザインとUIのインタラクション**

- **Scenario 17: デスクトップ表示**
  - GIVEN ユーザーがデスクトップPCでサイトを開く
  - WHEN ページが表示される
  - THEN 第1次相続、第2次相続、相続人セクションが横に並んで表示される

- **Scenario 18: スマートフォン表示**
  - GIVEN ユーザーがスマートフォンでサイトを開く
  - WHEN ページが表示される
  - THEN 第1次相続、第2次相続、相続人セクションが縦に並んで表示される

- **Scenario 19: 入力フォームの折りたたみ**
  - GIVEN 相続人リストが表示されている
  - WHEN 相続人カードのヘッダーをクリックする
  - THEN その相続人の詳細入力フォームが折りたたまれたり、展開されたりする

- **Scenario 20: 数値入力のフォーマット**
  - GIVEN ユーザーが金額入力フィールドに数字を入力する
  - WHEN フォーカスがフィールドから外れる
  - THEN 入力された数値が3桁区切りの通貨形式（例: 1,000,000円）に自動でフォーマットされる 